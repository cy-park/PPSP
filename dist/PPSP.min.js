(function(e,t){"use strict";if(typeof define==="function"&&define.amd){define(["SlideScroll"],function(n){return e.PPSP=t(n)})}else if(typeof module==="object"&&module.exports){module.exports=e.PPSP=t(require("slide-scroll"))}else{e.PPSP=t(e.SlideScroll)}})(typeof window!=="undefined"?window:this,function(e){"use strict";var t;function n(n){t=this;n=n||{};t.selector=n.selector||"section";t.duration=n.duration||700;t.enableStash=n.enableStash||false;t.lockViewport=n.lockViewport||false;t.onLeave=n.onLeave;t.afterLoad=n.afterLoad;t.onStash=n.onStash;t.afterStash=n.afterStash;t.el=document.querySelectorAll(t.selector);t.currentIndex=0;t.touchThreshold=n.touchThreshold||50;t.inTransit=false;t.pauseSnap=false;t._ss=new e({duration:n.duration});t._stash_data=[];t._touch_start;t._wheel={event_arr:[],timeout_holder:null};window.addEventListener("wheel",h);window.addEventListener("scroll",_);window.addEventListener("keydown",c);window.addEventListener("touchstart",p);window.addEventListener("touchmove",v);window.addEventListener("touchend",w);window.addEventListener("resize",g)}function r(e){var n=t.el[e];return n.hasAttribute("data-ppsp-skip")||window.getComputedStyle(n,null).getPropertyValue("display")==="none"?true:false}function a(e){var n=t.el[e];return n.hasAttribute("data-ppsp-stash")||t.enableStash?true:false}function o(){var e;if(t.el[0].getBoundingClientRect().top>0){e="outTop"}else{if(t.el[t.el.length-1].getBoundingClientRect().top<0)e="outBottom";else e="in"}return e}function i(e){e=e||t.currentIndex;var n=e-1;if(n>0)return r(n)?i(n):n;return 0}function l(e){e=e||t.currentIndex;var n=e+1;if(n<t.el.length-1)return r(n)?l(n):n;return t.el.length-1}function s(){var e=0,n=t.el[0].getBoundingClientRect().top;for(var a=1;a<t.el.length;a++){if(!r(a)){var o=t.el[a].getBoundingClientRect().top;if(Math.abs(n)>Math.abs(o)){e=a;n=o}else{if(r(e)){var s=i(e),u=l(e);var f=t.el[s].getBoundingClientRect().top,d=t.el[u].getBoundingClientRect().top;if(Math.abs(f)<Math.abs(d))e=s;else e=u}break}}}return e}function u(e){var n=t.currentIndex-e<0?"down":"up";var a=e;if(r(a)){a=n==="up"?i(a):l(a)}return a}function f(e,t){var n=0;var r=e.slice(Math.max(e.length-t,1));for(var a=0;a<r.length;a++){n+=Math.abs(r[a].deltaY)}return Math.ceil(n/t)}n.prototype.prev=function(e,n){t.goto(i(),e,n)};n.prototype.next=function(e,n){t.goto(l(),e,n)};n.prototype.goto=function(e,n,r){if(!t.inTransit){t.inTransit=true;d(u(e),n,r)}};function d(e,n,r){if(t.currentIndex!==e){var a=t.currentIndex-e<0?"down":"up";t._ss.duration=Math.abs(t.currentIndex-e)>1?0:t.duration;var o=a==="up"?i():l();var s=window.pageYOffset+t.el[o].getBoundingClientRect().top;if(t.onLeave)t.onLeave.call(t,o);t._ss.to(s,function(){t.cancelStash();if(t.afterLoad)t.afterLoad.call(t,o);t.currentIndex=o;d(e,n,r)})}else{if(r&&r.constructor!==Array)r=[r];if(n)n.apply(null,r);t.inTransit=false}}n.prototype.snap=function(){if(!t.inTransit&&!t.pauseSnap&&t.el[t.currentIndex].getBoundingClientRect().top!==0)t.goto(s())};n.prototype.refresh=function(e){e=e||t.selector;t.el=document.querySelectorAll(e);t.snap()};n.prototype.stash=function(e,n,r){if(!t.inTransit&&t._stash_data.length===0){var a=[e,n,r];if(t._stash_data[0]!==a[0]||t._stash_data[1]!==a[1]||t._stash_data[2]!==a[2]){if(t.onStash)t.onStash.call(t,a);t._stash_data=a;if(t.afterStash)t.afterStash.call(t,a)}}};n.prototype.pop=function(){t.goto.apply(t,t._stash_data)};n.prototype.cancelStash=function(){t._stash_data=[]};function h(e){if(t._wheel.event_arr.length>149)t._wheel.event_arr.shift();t._wheel.event_arr.push(e);var n=t._wheel.event_arr[t._wheel.event_arr.length-1].timeStamp;var r=e.timeStamp;if(r-n>250)t._wheel.event_arr=[];if(o()==="in"){var s=f(t._wheel.event_arr,10);var u=f(t._wheel.event_arr,70);var d=s>=u;var h=typeof e.wheelDeltaX!=="undefined"||typeof e.deltaX!=="undefined";var c=Math.abs(e.wheelDeltaX)<Math.abs(e.wheelDelta)||(Math.abs(e.deltaX)<Math.abs(e.deltaY)||!h);if(s>=u&&c&&!t._wheel.timeout_holder){t._wheel.timeout_holder=window.setTimeout(function(){window.clearTimeout(t._wheel.timeout_holder);t._wheel.timeout_holder=undefined},700);if(a(t.currentIndex)){e.preventDefault();if(e.deltaY<0)t.stash(i());else t.stash(l())}else{if(e.deltaY<0){if(t.currentIndex>0)e.preventDefault();t.prev()}else{if(t.currentIndex<t.el.length-1)e.preventDefault();t.next()}}}else{e.preventDefault()}}else{}}function c(e){if(o()==="in"){if(a(t.currentIndex)){if(e.key==="ArrowDown"){var n=l();if(t.currentIndex!==n){e.preventDefault();t.stash(l())}}else if(e.key==="ArrowUp"){var r=i();if(t.currentIndex!==r){e.preventDefault();t.stash(i())}}else if(e.key===" "){e.preventDefault();if(e.shiftKey)t.stash(i());else t.stash(l())}else{}}else{if(e.key==="ArrowDown"){t.next()}else if(e.key==="ArrowUp"){t.prev()}else if(e.key===" "){e.preventDefault();if(e.shiftKey)t.prev();else t.next()}else{}}}else{}}function p(e){t._touch_start=e.touches[0].clientY}function v(e){var n=e.touches[0].clientY;if(Math.abs(t._touch_start-n)>t.touchThreshold){if(o()==="in"){e.preventDefault();if(a(t.currentIndex)){if(t._touch_start-n<0)t.stash(i());else t.stash(l())}else{if(t._touch_start-n<0)t.prev();else t.next()}}else{}}}function w(e){}function _(e){if(t.lockViewport){window.setTimeout(t.snap,500)}else{if(!t.inTransit&&o()==="in")window.setTimeout(t.snap,500)}}function g(e){window.setTimeout(t.snap,500)}return n});