(function(e,t){"use strict";if(typeof define==="function"&&define.amd){define(["SlideScroll"],function(n){return e.PPSP=t(n)})}else if(typeof module==="object"&&module.exports){module.exports=e.PPSP=t(require("slide-scroll"))}else{e.PPSP=t(e.SlideScroll)}})(typeof window!=="undefined"?window:this,function(e){"use strict";var t;function n(n){t=this;n=n||{};t.selector=n.selector||"section";t.duration=n.duration||400;t.enableStash=n.enableStash||false;t.lockViewport=n.lockViewport||false;t.onLeave=n.onLeave;t.afterLoad=n.afterLoad;t.onStash=n.onStash;t.afterStash=n.afterStash;t.el=document.querySelectorAll(t.selector);t.currentIndex=0;t.inTransit=false;t._ss=new e({duration:n.duration});t._stash_data=[]}function o(e){var n=t.el[e];return n.hasAttribute("data-ppsp-skip")||window.getComputedStyle(n,null).getPropertyValue("display")==="none"?true:false}function a(e){var n=t.el[e];return n.hasAttribute("data-ppsp-stash")||t.enableStash?true:false}function r(){return t.el[0].getBoundingClientRect().top<0&&t.el[t.el.length-1].getBoundingClientRect().top>0?true:false}function i(e){e=e||t.currentIndex;var n=e-1;if(n>0)return o(n)?i(n):n;return 0}function s(e){e=e||t.currentIndex;var n=e+1;if(n<t.el.length-1)return o(n)?s(n):n;return t.el.length-1}function l(){var e=0,n=t.el[0].getBoundingClientRect().top;for(var a=1;a<t.el.length;a++){var r=t.el[a].getBoundingClientRect().top;if(Math.abs(n)>Math.abs(r)){e=a;n=r}else{if(o(e)){var l=i(e),f=s(e);var u=t.el[l].getBoundingClientRect().top,d=t.el[f].getBoundingClientRect().top;if(Math.abs(u)<Math.abs(d))e=l;else e=f}break}}return e}n.prototype.prev=function(e,n){t.goto(i(),e,n)};n.prototype.next=function(e,n){t.goto(s(),e,n)};n.prototype.goto=function(e,n,a){if(!t.inTransit){t.inTransit=true;if(a&&a.constructor!==Array)a=[a];if(o(e))e=t.currentIndex-e<0?s(e):i(e);var r=window.pageYOffset+t.el[e].getBoundingClientRect().top;if(t.onLeave)t.onLeave.call(t,e);t._ss.to(r,function(){t.currentIndex=e;t.cancelStash();t.inTransit=false;if(t.afterLoad)t.afterLoad.call(t);if(n)n.apply(null,a)})}};n.prototype.snap=function(){if(t.el[t.currentIndex].getBoundingClientRect().top!==0)t.goto(l())};n.prototype.refresh=function(e){e=e||t.selector;t.el=document.querySelectorAll(e);t.snap()};n.prototype.stash=function(e,n,o){if(!t.inTransit&&t._stash_data.length===0){var a=[e,n,o];if(t._stash_data[0]!==a[0]||t._stash_data[1]!==a[1]||t._stash_data[2]!==a[2]){if(t.onStash)t.onStash.call(t,a);t._stash_data=a;if(t.afterStash)t.afterStash.call(t,a)}}};n.prototype.pop=function(){t.goto.apply(t,t._stash_data)};n.prototype.cancelStash=function(){t._stash_data=[]};window.addEventListener("wheel",function(e){if(r()){e.preventDefault();if(a(t.currentIndex)){if(e.deltaY<0)t.stash(i());else t.stash(s())}else{if(e.deltaY<0)t.prev();else t.next()}}});window.addEventListener("keydown",function(e){if(r()){if(a(t.currentIndex)){if(e.key==="ArrowDown"){e.preventDefault();t.stash(s())}else if(e.key==="ArrowUp"){e.preventDefault();t.stash(i())}else if(e.key===" "){e.preventDefault();if(e.shiftKey)t.stash(i());else t.stash(s())}else{}}else{if(e.key==="ArrowDown"){e.preventDefault();t.next()}else if(e.key==="ArrowUp"){e.preventDefault();t.prev()}else if(e.key===" "){e.preventDefault();if(e.shiftKey)t.prev();else t.next()}else{}}}});window.addEventListener("scroll",function(e){if(t.lockViewport){window.setTimeout(t.snap,500)}else{if(r())window.setTimeout(t.snap,500)}});window.addEventListener("resize",function(e){window.setTimeout(t.snap,500)});return n});